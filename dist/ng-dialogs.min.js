!function(e,o){"object"==typeof exports&&"undefined"!=typeof module?o():"function"==typeof define&&define.amd?define(o):o()}(this,function(){"use strict";function e(){function e(e){return(e||"")+ ++o}var o=0;return{uniqueId:e}}function o(e,o,n,a,i,l,s,d){function c(e){return new u(e)}function u(c){function u(){S.$broadcast(t.SHOW),S.$dialog.visible=!0}function f(){S.$broadcast(t.HIDE),S.$dialog.visible=!1}function g(){S.$broadcast(t.DESTROY),S.$destroy(),h.remove(),C=null}function p(e){var n=o.defer(),a=n.resolve;n.reject;if(e.templateUrl){var t=s.get(e.templateUrl);t?a(t):l.get(e.templateUrl).then(function(o){s.put(e.templateUrl,o.data),a(o.data)},function(){throw new Error("ng-dialogs: failed to fetch template: "+e.templateUrl)})}else{if(!e.template)throw new Error("ng-dialogs: no template configuration found");a(e.template)}return n.promise}function m(e,o,n){var t=[o.templateBefore,n,o.templateAfter].join(""),r=angular.element(t),l=a(r);h=l(e),h.attr("id",o.id),h.addClass("ng-hide");var s={};if(s.hide=C.hide,s.show=C.show,s.destroy=C.destroy,s.visible=!1,e.$dialog=s,o.cssClass&&h.addClass(o.cssClass),o.controller){var d={$scope:e,dialog:C};o.controllerAs?i(o.controller,d,!1,o.controllerAs):i(o.controller,d)}if(o.plugins)for(var c=0;c<o.plugins.length;c++){var u=o.plugins[c];u(e,h,C,o)}var f=v(o);f.append(h)}function v(e){return angular.isElement(e.parent)?angular.element(e.parent):e.parent&&angular.isString(e.parent)?angular.element(n[0].querySelector(e.parent)):n.find("body")}var b=o.defer(),y={parent:void 0,id:void 0,cssClass:void 0,template:"",templateUrl:void 0,templateBefore:'<div ng-show="$dialog.visible">',templateAfter:"</div>",controller:angular.noop,controllerAs:void 0,plugins:[]},$=angular.extend({},y,c);$.id||($.id=r("ng-dialogs__"));var h,C={show:function(){var e=o.defer();return b.promise.then(function(){u(),d(e.resolve)}),e.promise},hide:function(){var e=o.defer();return b.promise.then(function(){f(),d(e.resolve)}),e.promise},destroy:function(){var e=o.defer();return f(),g(),d(e.resolve),e.promise}},S=e.$new();return p($).then(function(e){m(S,$,e),d(angular.noop),S.$broadcast(t.INIT),b.resolve()}),C}var f={createDialog:c};return f}function n(e,o,n){function a(e,o,n,a){a.autoShow===!0&&e.$on(t.INIT,n.show)}function r(e,a,r,i){if(i.focus){var l;e.$on(t.SHOW,function(){l=o[0].activeElement}),e.$on(t.OUTSIDE_CLICK,function(){l=null}),e.$on(t.HIDE,function(){n(function(){l&&(l.focus(),l=null)})})}}function i(e,a,r,i){i.focus&&e.$on(t.SHOW,function(){n(function(){var e="string"==typeof i.focus?a[0].querySelector(i.focus):o[0].getElementById(i.id);if(e){var n=angular.element(e);n.attr("tabindex",-1),e.focus()}})})}function l(e,o,n,a){e.$on(t.INIT,function(){var n=o[0].querySelector(".ng-dialogs-modal__backdrop");if(n){var a=angular.element(n);a.on("click",function(){e.$broadcast(t.BACKDROP_CLICK)})}})}function s(e,o,n,a){a.backdropClose&&(console.log(a.backdropClose),e.$on(t.BACKDROP_CLICK,n.destroy))}function d(e,o,n,a){a.outsideClose&&e.$on(t.OUTSIDE_CLICK,n.destroy)}function c(e,a,r,i){function l(o){s(o)&&e.$broadcast(t.OUTSIDE_CLICK)}function s(e){for(var o=!0,n=e.target;n.parentNode;){if(a[0]===n)return!1;n=n.parentNode}return o}e.$on(t.SHOW,function(){n(function(){o.on("click",l)})}),e.$on(t.HIDE,function(){o.off("click",l)})}function u(e,o,n){e.$on(t.INIT,function(){o[0].addEventListener("keydown",function(o){27===o.keyCode&&e.$broadcast(t.ESCAPE_PRESS)},!0)})}function f(e,o,n,a){a.escapeClose&&e.$on(t.ESCAPE_PRESS,n.destroy)}function g(o,n,a,r){function i(){return n[0].querySelector(r.frame)||n[0]}function l(e){e.prepend('<div class="ng-dialogs-tripwire--top" tabindex="0" aria-hidden="true"></div>'),e.append('<div class="ng-dialogs-tripwire--bottom" tabindex="0" aria-hidden="true"></div>')}function s(){return n[0].querySelectorAll("div[class^=ng-dialogs-tripwire]")}function d(e){for(var o,n=c(),a=i();n.length&&(o=e.shiftKey?n.pop():n.shift(),o.className.indexOf("ng-dialogs-tripwire")!==-1||o===a||!u(o));)o=void 0;o=o||a,o.focus()}function c(){var e="a[href], area[href], input:not([disabled]), select:not([disabled]), textarea:not([disabled]), button:not([disabled]), iframe, object, embed,  *[tabindex], *[contenteditable]";return[].slice.call(n[0].querySelectorAll(e))}function u(o){var n=e.getComputedStyle(o);return!(n.visibility&&"hidden"===n.visibility||n.opacity&&"0"===n.opacity)}r.focusTrap&&!r.modeless&&(o.$on(t.INIT,function(){var e=angular.element(i());l(e)}),o.$on(t.SHOW,function(){var e=s();e.forEach(function(e){angular.element(e).on("keyup keydown",d)})}),o.$on(t.HIDE,function(){var e=s();e.forEach(function(e){angular.element(e).off("keyup keydown",d)})}))}function p(e,o,n,a){function r(){for(var e in c)i(e,c[e])}function i(e,o){switch(e){case"role":l(e,o);break;case"aria-describedby":console.log(arguments),s(e,o);break;case"aria-labelledby":console.log(arguments),s(e,o)}}function l(e,o){var n=angular.element(d());n.attr(e,o)}function s(e,n){if(e&&n){var t=o[0].querySelector(n)||d();t=angular.element(t);var r=a.id+"--"+e;t.attr("id",r),t.attr(e,r)}}function d(){return o[0].querySelector(a.frame)||o[0]}var c=a.aria;c&&e.$on(t.INIT,r)}var m={autoShow:a,restoreFocus:r,dialogFocus:i,backdropEvent:l,backdropDestroy:s,outsideEvent:c,outsideDestroy:d,escapeEvent:u,escapeDestroy:f,focusTrap:g,aria:p};return m}function a(e,o){function n(n){var a={cssClass:"ng-dialogs-theme--basic",templateBefore:'<div class="ng-dialogs-modal" ng-show="$dialog.visible"><div class="ng-dialogs-modal__backdrop"></div><div class="ng-dialogs-modal__frame">',templateAfter:"</div></div>",autoShow:!0,frame:".ng-dialogs-modal__frame",focus:".ng-dialogs-modal__frame",focusTrap:!0,escapeClose:!0,outsideClose:!0,backdropClose:!0,aria:{role:"dialog","aria-describedby":".ng-dialogs-modal__frame"}},t={cssClass:"ng-dialogs-theme--basic",templateBefore:'<div class="ng-dialogs-modeless ng-dialogs-modeless__frame" ng-show="$dialog.visible">',templateAfter:"</div>",autoShow:!0,focus:!0,frame:".ng-dialogs-modeless__frame",escapeClose:!0,outsideClose:!0,backdropClose:!1},r=n.modeless===!0?t:a,i=angular.extend({},r,n),l=[o.autoShow,o.backdropEvent,o.backdropDestroy,o.outsideEvent,o.outsideDestroy,o.escapeEvent,o.escapeDestroy,o.dialogFocus,o.restoreFocus,o.focusTrap,o.aria];i.plugins=l,n.plugins&&n.plugins.forEach(function(e){i.plugins.push(e)});var s=e.createDialog(i);return s}var a={createDialog:n};return a}o.$inject=["$rootScope","$q","$document","$compile","$controller","$http","$templateCache","$timeout"],n.$inject=["$window","$document","$timeout"],a.$inject=["ngDialogsCoreService","ngDialogsCorePluginsService"];var t={INIT:"dialog:init",SHOW:"dialog:show",HIDE:"dialog:hide",DESTROY:"dialog:destroy",BACKDROP_CLICK:"dialog:backdrop_click",OUTSIDE_CLICK:"dialog:outside_click",ESCAPE_PRESS:"dialog:escape_press"},r=(new e).uniqueId;angular.module("ng-dialogs-core",[]),angular.module("ng-dialogs-messagebox",["ng-dialogs-core"]),angular.module("ng-dialogs-modal",["ng-dialogs-core"]),angular.module("ng-dialogs",["ng-dialogs-messagebox","ng-dialogs-modal"]),angular.module("ng-dialogs-core").factory("ngDialogsCoreService",o),angular.module("ng-dialogs-core").factory("ngDialogsCorePluginsService",n),angular.module("ng-dialogs-modal").factory("ngDialogsModalService",a)});
//# sourceMappingURL=ng-dialogs.min.js.map
